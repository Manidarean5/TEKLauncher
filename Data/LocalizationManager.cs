using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using static System.Windows.Application;
using static TEKLauncher.Data.Settings;
using static TEKLauncher.Utils.TEKArchive;

namespace TEKLauncher.Data
{
    internal static class LocalizationManager
    {
        internal static string LocCulture;
        private static readonly Dictionary<LocCode, string> List = new Dictionary<LocCode, string>();
        internal static readonly string[] SupportedCultures = new[] { "en", "es", "ru", "ar" };
        internal static void LoadLocalization(string CultureCode)
        {
            if (Lang.Length == 0)
            {
                if (CultureCode.Length < 2)
                    LocCulture = "en";
                else
                {
                    LocCulture = CultureCode.Substring(0, 2);
                    if (LocCulture == "be" || LocCulture == "uk")
                        LocCulture = "ru";
                    if (!SupportedCultures.Contains(LocCulture))
                        LocCulture = "en";
                }
                Lang = LocCulture;
            }
            else
                LocCulture = Lang;
            using (Stream ResourceStream = GetResourceStream(new Uri($"pack://application:,,,/Resources/Localizations/{LocCulture}.ta")).Stream)
            using (MemoryStream Stream = new MemoryStream())
            {
                DecompressSingleFile(ResourceStream, Stream);
                Stream.Position = 0L;
                using (StreamReader Reader = new StreamReader(Stream))
                {
                    for (LocCode Code = LocCode.CantLaunchExeMissing; Code <= LocCode.PrepCommunismMode; Code++)
                        List.Add(Code, Reader.ReadLine().Replace(@"\n", "\n"));
                    string AboutFeatures = string.Empty;
                    while (!Reader.EndOfStream)
                    {
                        AboutFeatures += $"• {Reader.ReadLine()}";
                        if (!Reader.EndOfStream)
                            AboutFeatures += "\n";
                    }
                    List.Add(LocCode.AboutFeatures, AboutFeatures);
                }
            }
        }
        internal static string LocString(LocCode Code) => List[Code];
        internal enum LocCode
        {
            CantLaunchExeMissing,
            CantLaunchCorruped,
            CantLaunchNoSteam,
            CantLaunchNoCreamAPI,
            CantJoinNoInternet,
            CantLaunchNoSpacewar,
            Status,
            DLCUninstPrompt,
            NotInstalled,
            Installed,
            CheckingForUpdates,
            UpdateAvailable,
            Downloading,
            PlayPage,
            ServersPage,
            DLCsPage,
            ModsPage,
            SettingsPage,
            LauncherPage,
            AboutPage,
            InfoFileMissing,
            ModID,
            OriginalID,
            Subscribed,
            NotSubscribed,
            ModIDCopied,
            InstallingMod,
            ModInstallError,
            FailedToSub,
            FailedToUnsub,
            Dismiss,
            KB,
            MB,
            GB,
            Second,
            Join,
            DLCNotInstalled,
            Install,
            KeyFeatures,
            Links,
            DownloadLink,
            Discords,
            MainInfo,
            AddServers,
            CPServers,
            CPInfo,
            CPMods,
            CPDiscord,
            ClusterName,
            HostedBy,
            Subscribe,
            Loading,
            GamePath,
            DelSettings,
            CleanDwCache,
            DwThreadsCountTooltip,
            DwThreadsCount,
            AutoRetry,
            CloseOnGameRun,
            CommunismMode,
            GamePathPrompt,
            CantUsePath,
            CleanDwCachePrompt,
            DelSettingsPrompt,
            MIARKID,
            MIPlaceholder,
            MIOr,
            BrowseWorkshop,
            MISpacewarID,
            MISelectID,
            Idle,
            DownloadFailed,
            ValidatorExc,
            MISubscribing,
            MISubFailed,
            MISuccess,
            Cancelling,
            MIEnterARKID,
            MIARKdictedPrompt,
            MIRequestingDetails,
            MIDefaultModName,
            MISubSuccess,
            MIEnterSpacewarID,
            MIIDInUse,
            MIRequestFailed,
            MINoARKMod,
            MINotAnARKMod,
            MINoSpacewarMod,
            MINotASpacewarMod,
            MIPvNotASpacewarMod,
            MIPvNotAnARKMod,
            MIPvFailed,
            MIPvNoMod,
            MIAllIDsUsed,
            InstallMod,
            MINoSpacewar,
            RunGameAsAdmin,
            UseSpacewar,
            UseBattlEye,
            Play,
            Lang,
            GameLoc,
            ca,
            cs,
            da,
            de,
            en,
            es,
            eu,
            fi,
            fr,
            hu,
            it,
            ja,
            ka,
            ko,
            nl,
            pl,
            pt,
            ru,
            sv,
            th,
            tr,
            uk,
            zh,
            zh_hans,
            zh_tw,
            CustomLaunchParameters,
            SwitchLangPrompt,
            NeedCreamAPI,
            NeedNoCreamAPI,
            ServersPageNote,
            ClusterServers,
            ClusterPlayers,
            Update,
            FixBE,
            UnlockSkins,
            UninstallAllMods,
            Validate,
            FixBloom,
            InstallSpacewar,
            InstallReqs,
            FilesUpToDate,
            FilesOutdated,
            FilesMissing,
            CreamAPI,
            Reapply,
            UseGlobalFonts,
            LaunchParameters,
            UseCacheDesc,
            UseCache,
            UseAllCoresDesc,
            UseAllCores,
            HighPriorDesc,
            HighPrior,
            NoFXAAFontsDesc,
            NoFXAAFonts,
            SM4Desc,
            SM4,
            DX10Desc,
            DX10,
            NoSplashDesc,
            NoSplash,
            NoSkyDesc,
            NoSky,
            NoMemBiasDesc,
            NoMemBias,
            LowMemDesc,
            LowMem,
            NoRHIDesc,
            NoRHI,
            NoVSyncDesc,
            NoVSync,
            NoHibDesc,
            NoHib,
            AnselDesc,
            Ansel,
            SPDownloading,
            SPDownloadFailed,
            CantFixBEGameRunning,
            CantFixBEExeMissing,
            BattlEye,
            ExtractingArchive,
            BEFixSuccess,
            FailedToExtract,
            CantFixBloom,
            BloomFixSuccess,
            Requirements,
            InstallingReq,
            InstallReqSuccess,
            SpacewarInstalled,
            SpacewarNeedsSteam,
            GameDownloadBegan,
            SPPrepToDownload,
            CantReapplyGameRunning,
            ReapplySuccess,
            GlobalFonts,
            GlobalFontsSuccess,
            Pause,
            CantInstallCA,
            CantUninstallCA,
            InstallCASuccess,
            UninstallCASuccess,
            CantUnlockSkins,
            LocalProfile,
            SkinUnlockSuccess,
            Uninstall,
            CantUpdateGameRunning,
            CantUpdateNoInternet,
            Search,
            WBTimeout,
            WBPage,
            ConnectToSteamFailed,
            MaxDinoLvl,
            Taming,
            Experience,
            Harvesting,
            Breeding,
            Stacks,
            YourServers,
            ReadingOldManifest,
            DwLatestManifest,
            DwManifestFailed,
            ReadingLatestManifest,
            FetchServersFailed,
            ManifestCorrupted,
            ManifestDecryptFailed,
            Game,
            CantInstallUpdate,
            InstallationCorrupted,
            InstallFailedVCDupe,
            PathTooLong,
            NotEnoughSpace,
            ManifestDecryptedIncorrectly,
            ComputingChanges,
            ValidatingFiles,
            ConnectingToSteam,
            RequestingData,
            Timeout,
            Preallocating,
            DownloadingMod,
            DwPaused,
            CInstallingMod,
            GameAlrUpToDate,
            ValidationPaused,
            AlrUpToDate,
            DownloadingUpd,
            InstallingUpd,
            UpdateSuccess,
            ModAlrUpToDate,
            CommittingUpd,
            ModUpdSuccess,
            CantStartLauncher,
            SelectFolder,
            ModDecompressFailed,
            AddServer,
            ServerIP,
            EnterIP,
            Add,
            IPNotValid,
            ScanningServers,
            NoServersFound,
            AddServerSuccess,
            WhatsNew,
            WNUpdate,
            WNPatch,
            Crash,
            CrashCaption,
            CrashUploading,
            NFRequired1,
            NFRequired2,
            NFRequired3,
            CrashSent,
            CrashPost1,
            CrashPost2,
            GameVersion,
            CritFilesMissing,
            LUpdateAvailable,
            NoInternet,
            Latest,
            Outdated,
            ARKUpdateAvailable,
            None,
            CheckingForDLCUpds,
            DLCUpdsAvailable,
            NA,
            LauncherClosePrompt,
            MWError,
            MWInfo,
            MWWarning,
            Yes,
            No,
            OK,
            MUCaption,
            MUSelectOptions,
            MUUnsubAllMods,
            MUDelWorkshop,
            MUDelInstalled,
            MUCleanACF,
            MUCleanDwCache,
            MUUninstallMods,
            MUCantUninst,
            MUGameRunning,
            MUPrompt,
            MUUninstalling,
            MUFail,
            MUSuccess,
            StartupMessage,
            SelectARKFolder,
            ReqDiskSpace,
            FreeDiskSpace,
            Continue,
            UpdaterCaption,
            UpdaterPrep,
            UpdaterDownloading,
            UpdaterFail,
            UpdaterFailLink,
            DLCValidator,
            ModValidator,
            ValidatorClosePrompt,
            ValidatorWaitingForCancel,
            ValidatorCloseWindow,
            Retry,
            PrepCommunismMode,
            AboutFeatures
        }
    }
}